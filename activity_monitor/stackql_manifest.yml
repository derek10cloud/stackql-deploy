version: 1
name: activity_monitor
description: oss activity monitor stack
providers:
  - azure
globals:
  - name: SUBSCRIPTION_ID
    description: azure subscription id
    value: "{{ vars.AZURE_SUBSCRIPTION_ID }}"
  - name: LOCATION
    value: eastus
resources:
  - name: monitor_resource_group
    description: azure resource group for activity monitor
    deploy: stackql_models/resource_group.iql
    test: stackql_tests/resource_group.iql
    teardown: 
      "DELETE FROM azure.resources.resource_groups WHERE resourceGroupName = '{{ resource_group_name }}' AND subscriptionId = '{{ subscription_id }}'"
    props:
      - name: location
        description: azure resource group location
        value: "{{ globals.LOCATION }}"
      - name: subscription_id
        description: azure subscription id
        value: "{{ globals.SUBSCRIPTION_ID }}"
      - name: resource_group_name
        description: azure resource group name
        value: "activity-monitor-{{ globals.environment }}"
        # OR YOU CAN DO...
        # values:
        #   prd:
        #     value: "activity-monitor-prd"
        #   sit:
        #     value: "activity-monitor-sit"
        #   dev:
        #     value: "activity-monitor-dev"
